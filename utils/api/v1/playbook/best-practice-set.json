{
  "stagename": "working-files/bestpractice-",
  "header-comment": "*****************************************************************************************************************************************************\n*                                                                                                                                                   *\n*  This script makes all of the required changes to set all Security Profiles to best practice blocking settingsin your  PAN-OS XML configuration file.                                         *\n*             (To achieve ‘Visibility’ the script can be used 'as is' without any changes).                                                         *\n*                                                                                                                                                   *\n*  This script will need you to only do the following two things;                                                                                   *\n*    i) Rename the input file referenced in the first pan-os-php command below to be the XML configuration file being used (eg: example_panos.xml). *\n*    ii) Copy the input file from the above (ie: example_panos.xml) to the pan-os-php staging directory so that it can be referenced by this script.*\n*                                                                                                                                                   *\n*****************************************************************************************************************************************************\n\n*****************************************************************************************************************************************************\n*                                                                                                                                                   *\n*  The script will now begin and will run a sequence of pan-os-php commands.                                                                        *\n*  Each new command will use the outputfile of the previous command as the input file of the new command.                                           *\n*  The final xml file generated by the last command in this script should then be imported, and then loaded into the PAN-OS firewall.               *\n*                                                                                                                                                   *\n*****************************************************************************************************************************************************",
  "footer-comment": "*****************************************************************************************************************************************************\n*                                                                                                                                                   *\n*   Best Practice playbook FINALISED                                                                                                                   *\n*                                                                                                                                                   *\n*****************************************************************************************************************************************************",
  "command": [
    {
      "type": "securityprofile",
      "securityprofiletype": "securityprofiletype=virus",
      "actions": "actions=virus.best-practice-set",
      "filter" : "filter=!(name eq Alert-Only-AV)",
      "location": "location=any"
    },
    {
      "type": "securityprofile",
      "securityprofiletype": "securityprofiletype=spyware",
      "actions": "actions=spyware.best-practice-set",
      "filter" : "filter=!(name eq Alert-Only-AS)",
      "location": "location=any"
    },
    {
      "type": "securityprofile",
      "securityprofiletype": "securityprofiletype=vulnerability",
      "actions": "actions=vulnerability.best-practice-set",
      "filter" : "filter=!(name eq Alert-Only-VP)",
      "location": "location=any"
    }
  ]
}